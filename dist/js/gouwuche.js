"use strict";$(document).ready(function(){var t=$(".tuichu"),e=$(".xrname");if(""!=window.localStorage.mobile){var a=window.localStorage.mobile;e.empty().attr("href","javascript:void(0);").text(a),t.css("display","block")}else""==window.localStorage.mobile&&e.empty().attr("href","./html/login.html").text("请登录");t.on("click",function(){t.css("display","none"),window.localStorage.mobile="",window.localStorage.password="",window.localStorage.Arr="",e.empty().attr("href","../index.html").text("请登录")});var o,i,n=window.localStorage.mobile,r=$(".tbodylist"),l=0,d=0;function s(e,t){$.get("../api/gouwuche3.php",{id:t},function(t){l+=e*t[0].price,d+=e,str="",str+='<tr data-id="'+t[0].id+'"><td><input class="checkbtn" type="checkbox" /></td><td class="imgbox"><img src=".'+t[0].src+'" alt="" /></td><td class="content">'+t[0].content+'</td><td class="price">￥'+t[0].price+'</td><td class="jisuanqty"><span class="jian">-</span><input class="num" readonly="readonly" type="text" value="'+e+'"/><span class="jia">+</span></td><td class="totalprice">￥'+e*t[0].price+'</td><td><a class="del" href="javacript:void(0);">删除</a><a class="shoucang" href="javacript:void(0);">移入收藏</a></td></tr>',r.append(str)},"json"),setTimeout(function(){$(".heji").text(l),$(".jianshu").text(d)},50)}$.get("../api/gouwuche2.php",{mobile:n},function(t){for(window.localStorage.Arr=t[0].num,o=$.parseJSON(t[0].num),d=l=0,console.log(o),i=0;i<o.length;i++)s(o[i].qty,o[i].id)},"json"),setTimeout(function(){var t=$("#all"),e=$(".checkbtn");t.on("click",function(){e.prop("checked",this.checked),$("#allbtn").prop("checked",this.checked)}),e.on("click",function(){e.filter(":checked").length==e.length?(t[0].checked=!0,$("#allbtn")[0].checked=!0):(t[0].checked=!1,$("#allbtn")[0].checked=!1)}),$("#allbtn").on("click",function(){e.prop("checked",this.checked),t.prop("checked",this.checked)}),$("table tbody").on("click",function(t){if("jia"==t.target.className){var e=Number($(t.target).prev().val());e+=1,$(t.target).prev().val(e);var a=$(t.target).parent().parent()[0].dataset.id;r.empty();for(var i=d=l=0;i<o.length;i++){if(o[i].id==a){o[i].qty++;var c=JSON.stringify(o);window.localStorage.Arr=c,$.get("../api/gouwuche.php",{mobile:n,id:c},function(t){console.log(t)},"json")}s(o[i].qty,o[i].id)}}if("jian"==t.target.className){e=Number($(t.target).next().val());e-=1,$(t.target).next().val(e);a=$(t.target).parent().parent()[0].dataset.id;r.empty();for(i=d=l=0;i<o.length;i++){if(o[i].id==a){o[i].qty--,o[i].qty<=0&&(o[i].qty=0);c=JSON.stringify(o);window.localStorage.Arr=c,$.get("../api/gouwuche.php",{mobile:n,id:c},function(t){},"json")}s(o[i].qty,o[i].id)}}if("del"==t.target.className){a=$(t.target).parent().parent()[0].dataset.id;r.empty();for(i=d=l=0;i<o.length;i++){if(o[i].id==a){o.splice(i,1);c=JSON.stringify(o);window.localStorage.Arr=c,$.get("../api/gouwuche.php",{mobile:n,id:c},function(t){},"json")}s(o[i].qty,o[i].id)}$(t.target).parent().parent().remove()}})},400)});